![5f213b6de73aa46339ad8123595fc898-0](https://github.com/gogiri/AvocadoProject/assets/139231430/a9bcce12-dc2e-4446-b157-a6a7191c5fe6)
![5f213b6de73aa46339ad8123595fc898-1](https://github.com/gogiri/AvocadoProject/assets/139231430/68b9f1bf-d5bf-4df9-8f27-fc1e57672fd5)
![5f213b6de73aa46339ad8123595fc898-2](https://github.com/gogiri/AvocadoProject/assets/139231430/9bfea4bc-f111-4229-85a2-524335d2667e)
![5f213b6de73aa46339ad8123595fc898-3](https://github.com/gogiri/AvocadoProject/assets/139231430/ef0b505c-259e-41ab-8947-48892c619844)
![5f213b6de73aa46339ad8123595fc898-4](https://github.com/gogiri/AvocadoProject/assets/139231430/cf55a8a9-29e5-4f4b-89f1-45a6e0f79659)
![5f213b6de73aa46339ad8123595fc898-5](https://github.com/gogiri/AvocadoProject/assets/139231430/48a105f0-6bfc-4152-bc2f-9e8e7c8ab01c)
![5f213b6de73aa46339ad8123595fc898-6](https://github.com/gogiri/AvocadoProject/assets/139231430/d8eb4f60-1db9-4c27-bf58-16d63208a43f)
![5f213b6de73aa46339ad8123595fc898-7](https://github.com/gogiri/AvocadoProject/assets/139231430/70f7f686-66a1-469d-a873-0661ce9c5207)
![5f213b6de73aa46339ad8123595fc898-8](https://github.com/gogiri/AvocadoProject/assets/139231430/b77b1640-3889-4641-999b-60f2c4608a6b)
![5f213b6de73aa46339ad8123595fc898-9](https://github.com/gogiri/AvocadoProject/assets/139231430/51e82c0a-2258-4e90-ade7-b1a5c67d6df2)
![5f213b6de73aa46339ad8123595fc898-10](https://github.com/gogiri/AvocadoProject/assets/139231430/f616b96e-0b00-4cd9-be18-501d737f9e84)
![5f213b6de73aa46339ad8123595fc898-11](https://github.com/gogiri/AvocadoProject/assets/139231430/4b41da0a-aca0-470b-8ed7-c84f6c4201ec)
![5f213b6de73aa46339ad8123595fc898-12](https://github.com/gogiri/AvocadoProject/assets/139231430/e03a63be-75c7-4240-9bb7-02eeac508e3d)
![5f213b6de73aa46339ad8123595fc898-13](https://github.com/gogiri/AvocadoProject/assets/139231430/6e989c26-aee8-4e9e-bc36-a67ead2ca478)
![5f213b6de73aa46339ad8123595fc898-14](https://github.com/gogiri/AvocadoProject/assets/139231430/abd1e400-5113-4de8-a3f7-20e98f9ae625)
![5f213b6de73aa46339ad8123595fc898-15](https://github.com/gogiri/AvocadoProject/assets/139231430/3db84a04-b95d-4ef2-8db4-4ab4fa274b6b)
![5f213b6de73aa46339ad8123595fc898-16](https://github.com/gogiri/AvocadoProject/assets/139231430/8d6e873f-4cc9-4c49-beb7-5ec6e1647eae)
![5f213b6de73aa46339ad8123595fc898-17](https://github.com/gogiri/AvocadoProject/assets/139231430/31e07eac-21ce-49f9-bb99-432cffdac7a1)
![5f213b6de73aa46339ad8123595fc898-18](https://github.com/gogiri/AvocadoProject/assets/139231430/2e153e5c-f2f6-4250-a8ca-7980b26f38b9)
![5f213b6de73aa46339ad8123595fc898-19](https://github.com/gogiri/AvocadoProject/assets/139231430/fc47ff82-e55c-4100-875d-e29427448670)
![5f213b6de73aa46339ad8123595fc898-20](https://github.com/gogiri/AvocadoProject/assets/139231430/5331c05a-f454-4e88-b645-187b309805eb)
![5f213b6de73aa46339ad8123595fc898-21](https://github.com/gogiri/AvocadoProject/assets/139231430/f8be71ac-55a4-472c-9c01-938a2193b7b8)
![5f213b6de73aa46339ad8123595fc898-22](https://github.com/gogiri/AvocadoProject/assets/139231430/c9268268-87be-416b-8336-3a5986d26f17)
![5f213b6de73aa46339ad8123595fc898-23](https://github.com/gogiri/AvocadoProject/assets/139231430/ebd50fb6-5eb0-4e68-9414-817163e37f8e)
![5f213b6de73aa46339ad8123595fc898-24](https://github.com/gogiri/AvocadoProject/assets/139231430/246c153c-5851-4a22-854c-a96a5921a0a8)
![5f213b6de73aa46339ad8123595fc898-25](https://github.com/gogiri/AvocadoProject/assets/139231430/02dd84d5-a927-4ca6-85c1-6f27fbf29ba6)
![5f213b6de73aa46339ad8123595fc898-26](https://github.com/gogiri/AvocadoProject/assets/139231430/f1734a33-59c2-42d9-b663-0a88d8bb80a5)
![5f213b6de73aa46339ad8123595fc898-27](https://github.com/gogiri/AvocadoProject/assets/139231430/01579cf6-2c9f-4734-ba9b-5e71381d56f8)
![5f213b6de73aa46339ad8123595fc898-28](https://github.com/gogiri/AvocadoProject/assets/139231430/3a3535d5-67ba-4812-913d-324dc4da3061)
![5f213b6de73aa46339ad8123595fc898-29](https://github.com/gogiri/AvocadoProject/assets/139231430/8aed0833-8b50-4243-9e5f-1b43b50c0362)
![5f213b6de73aa46339ad8123595fc898-30](https://github.com/gogiri/AvocadoProject/assets/139231430/7c112fae-05f5-474f-aaba-d65e3d20174d)
![5f213b6de73aa46339ad8123595fc898-31](https://github.com/gogiri/AvocadoProject/assets/139231430/241ac7b1-f963-47ef-8a08-514ced27d54c)
![5f213b6de73aa46339ad8123595fc898-32](https://github.com/gogiri/AvocadoProject/assets/139231430/b7307f1c-7b91-4809-9aae-e95173a7fc79)
![5f213b6de73aa46339ad8123595fc898-33](https://github.com/gogiri/AvocadoProject/assets/139231430/a663d59a-3c68-4e1a-92e4-877b6fb0f6ec)
![5f213b6de73aa46339ad8123595fc898-34](https://github.com/gogiri/AvocadoProject/assets/139231430/e4197484-9c37-4899-9412-09323cad1b1e)
![5f213b6de73aa46339ad8123595fc898-35](https://github.com/gogiri/AvocadoProject/assets/139231430/ab35483d-8579-40f9-b8e6-3f5d56712e86)
![5f213b6de73aa46339ad8123595fc898-36](https://github.com/gogiri/AvocadoProject/assets/139231430/ce334481-9551-4463-ba6d-21d797142374)
![5f213b6de73aa46339ad8123595fc898-37](https://github.com/gogiri/AvocadoProject/assets/139231430/81f96b2c-65f0-4aea-8b26-65f1a208132a)
![5f213b6de73aa46339ad8123595fc898-38](https://github.com/gogiri/AvocadoProject/assets/139231430/2ddaec5b-02d1-46ac-9101-c5828a63f301)
![5f213b6de73aa46339ad8123595fc898-39](https://github.com/gogiri/AvocadoProject/assets/139231430/c0fc5944-6f8f-4ea4-b3cf-8c8058da34bf)
![5f213b6de73aa46339ad8123595fc898-40](https://github.com/gogiri/AvocadoProject/assets/139231430/b829c8ec-a40f-4930-8fd0-696f1a0a81f5)
![5f213b6de73aa46339ad8123595fc898-41](https://github.com/gogiri/AvocadoProject/assets/139231430/34d0cb01-54dd-438c-9050-193fef1c2e62)
![5f213b6de73aa46339ad8123595fc898-42](https://github.com/gogiri/AvocadoProject/assets/139231430/870a22f5-7dee-4bee-aa4e-06009561a123)
![5f213b6de73aa46339ad8123595fc898-43](https://github.com/gogiri/AvocadoProject/assets/139231430/3ab4455a-960a-4f9c-8ab3-cac806f21d59)
![5f213b6de73aa46339ad8123595fc898-44](https://github.com/gogiri/AvocadoProject/assets/139231430/2f3e1480-ed3d-4592-a5be-347f8ae13c14)
![5f213b6de73aa46339ad8123595fc898-45](https://github.com/gogiri/AvocadoProject/assets/139231430/62cc8a3e-0071-49c4-8cf3-4bb737e5d5ff)
![5f213b6de73aa46339ad8123595fc898-46](https://github.com/gogiri/AvocadoProject/assets/139231430/9d847f00-a550-4876-995b-13afc425046c)

1. 주제선정배경
- 최근 미국 주식 투자에 대한 관심도가 증가하고 있다. 하지만 미국과 한국과의 시차 특성상 새벽에 열리는 미국시장에 적극적으로 투자하기 어렵다.
- 투자를 할 때, Top down방식과 Bottom up 방식에는 상당한 리서치 기간과 노력이 필요하다.
- 주식을 장기 보유할 경우, 손실에 대한 리스크도 초보 투자자에겐 부담으로 작용할 수 있다.

- 이러한 점을 고려해 ‘미국시장’을 ‘단기적’으로 투자하면서도 위험이 분산된 ‘ETF’를 활용하여 투자 전략을 만들어 보았다.
- ‘한국 시장에 상장된 미국 ETF’를 활용하는 전략이다.
- KODEX S&P500 섹터별 ETF를 투자대상으로 삼았다. 이 상품은 S&P 500 구성종목을 각 섹터별로 분리해 만든 ETF이다.
  미국 섹터별 ETF에 대한 관심도가 높아짐에 따라 삼성자산운용에서는 올해 8월 새로운 섹터의 ETF를 추가하기도 하였다. 

- KODEX S&P 500 섹터별 ETF와 S&P500 섹터별 ETF의 상관분석을 통해 상관성이 있음(0.50)을 확인했다.
- 한국 시장에서 해당 ETF 시장이 열리는 만큼 한국 시장 개장 때의 영향이 없어야 하므로 각 KODEX 섹터 ETF와 코스피 지수와의 관계를 파악하기 위해 표준편차가 0임을 확인했고
- KOSPI와 KODEX 섹터 ETF간 유의미한 상관관계가 도출되지 않아 (-0.12), 전략이 사용될 전반적인 전제에 대해 검증하였다.

3. 데이터 수집 및 전처리
- 투자전략을 실행시키는 데 있어서 가장 중요한 피처는 한국 시장 기준, 오늘(t기)의 한국시장과 오늘(t기) 새벽에 종료된 미국 시장에 대한 데이터라고 생각했다.
- 한국 피처 후보로는 우선 한국 코스피 200의 섹터별 평균 수익률과 시가총액 비중을 고려한 섹터별 거래량, 환율, 국고채 일별 수익률, 고가 저가 비율, KODEX S&P500 섹터 ETF의 괴리율을 고려했다.
- 미국 피처 후보로는 S&P500 섹터별 ETF의 주간 수익률, 환율, 유가 선물, 원자재 선물, BDI 및 SOX 지수에 대한 일별 수익률과 고가 저가의 비율을 고려했다. 
- Random Forest의 Feature importance로 피처 셀렉션을 진행했고, 섹터별 산업 특성을 고려해 섹터마다 피처를 다르게 선택했다. 섹터별로 선택된 피처를 바탕으로 모델링을 진행했다.

5. 데이터 모델링 및 성능평가
- 피처셀렉션에서 도출한 섹터별 피처를 바탕으로 RandomForest Classifier, LGBM, XGBoost, Logistic Regression, SVM Classifier 모델을 통해 accuracy를 확인하고 test 예측값을 도출했다.
- 모든 모델에 대해 백테스팅을 진행했다. 각 섹터별 KODEX S&P500 ETF의 test 기간의 보유수익률을 벤치마크로 삼았다.
- 상승 신호가 발생할 경우, KODEX S&P500 섹터별 ETF를 종가에 매수하고, 그 다음 날 시가에 매도하는 방식으로 투자전략을 수립하였다.
- 섹터별 상장 기간이 상이해, KODEX ETF를 기준으로, 상장일을 고려하여 test size를 약 0.3으로 하여 백테스팅 기간을 다르게 적용했다.
- 산업재(2017.05-2018.06, 2022.03-2023.10), 에너지(2017.07-2018.06, 2022.03-2023.10), 헬스케어, 금융, 필수소비재, 경기소비재(2023.08-2023.10, 4개 섹터 공통)로 백테스팅 기간을 설정하였다.

- 백테스팅 결과 산업재, 에너지의 섹터의 경우, 모델 평균 수익률이 벤치마크 대비 높았다. 특히 2022.02~2023.10에서의 에너지 섹터에서 Random Forest모델을 적용했을 때 벤치마크가 -27.37%인 반면, 아보카도팀의 전략으로 15.67%의 수익률을 얻을 수 있었다.
- 헬스케어, 필수소비재, 금융, 경기소비재 섹터의 경우 헬스케어를 제외하고 벤치마크 대비 underperfom을 보였다.

4. 결론
- 위의 과정을 통해, 각 섹터마다 유의한 피처들을 확인하였고 환율, 원자재, 원유 등 17가지 거시변수는 모든 섹터에 공통적으로 포함되는 것을 확인하였다.
- 이후 모델 예측 값과 투자 전략에 대한 백테스팅을 진행한 결과 KODEX S&P500 섹터별 ETF는 대체로 산업재, 에너지 섹터와 같은 ‘경기민감주’에 대한 투자수익률이 높았고 시장이 하락세일 때도 시장보다 덜 하락하는 경향이 있었다.
- 그리고 미국 S&P500 섹터를 추종하기 때문에 해당 섹터 ETF에 대한 52주 베타 값을 확인하였고 산업재, 에너지는 각각 1.13, 1.05, 헬스케어와 필수소비재는 각각 0.68, 0.62였다.

5. 한계점
- 헬스케어, 필수소비재, 금융, 경기소비재 4개의 섹터 ETF는 최근 상장된 ETF로 데이터 수가 부족하여 신뢰성이 떨어진다.
- 테스트 기간의 벤치마크 수익률을 고려할때, 투자결정을 내리지 않는 판단만으로도 벤치마크를 이길 가능성이 높은 섹터가 존재한다.
  실제로 몇몇 섹터에서 하락구간은 물론 상승구간에서도 투자결정을 거의 내리지 않았음에도 벤치마크보다 높은 수익률을 기록했다.
  따라서 모델로서 수익률이 개선되었다고 파악하기에는 어려운 점이 존재한다.
  
- 모델마다 수익률의 편차가 크게 달라졌다. 같은 tree기반 임에도 차이를 보이는 점에서 모델의 안정성이 떨어진다. 선형 모델을 위한 전처리와 피처셀렉도 진행해보았지만 크게 개선되지 못하였다.
  
- 하이퍼파라미터를 찾는 과정에서 grid_search에만 의존한 점, 검증방법에서 시계열적 특성을 반영하지 못한 점 등 과정에서 한계점 또한 존재한다.
